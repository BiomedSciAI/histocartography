inputs:
- image_path
outputs:
- assignment_matrix
stages:
  - preprocessing:
      class: "ImageLoader"
      inputs:
      - image_path
      outputs:
      - image
  - preprocessing:
      class: "GaussianTissueMask"
      inputs:
      - image
      outputs:
      - tissue_mask
      params:
        kernel_size: 5
  - preprocessing:
      class: "NucleiExtractor"
      inputs:
      - image
      - tissue_mask
      outputs:
      - nuclei_map
      - nuclei_centroids
      params:
        pretrained_data: 'pannuke'
  - preprocessing:
      class: "ColorMergedSuperpixelExtractor"
      inputs:
      - image
      - tissue_mask
      outputs:
      - merged_superpixels_map
      - initial_superpixels_map
      params:
        superpixel_size: 100
        max_nr_superpixels: 10000
        downsampling_factor: 8
  - preprocessing:
      class: "AssignmnentMatrixBuilder"
      inputs:
      - nuclei_centroids
      - merged_superpixels_map
      outputs:
      - assignment_matrix
