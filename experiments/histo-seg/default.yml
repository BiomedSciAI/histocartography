preprocess:
  stages:
    stain_normalizer:
      class: "VahadaneStainNormalizer"
      params:
        target: "ZT111_4_C_7_1"
    superpixel_extractor:
      class: "SLICSuperpixelExtractor"
      params:
        nr_superpixels: 2000
        color_space: "rgb"
    feature_extractor:
      class: "DeepFeatureExtractor"
      params:
        architecture: "resnet18"
        mask: False
        size: 224
    graph_builder:
      class: "RAGGraphBuilder"
      params:
        nr_classes: 5
  params:
    cores: 64
    labels: True
upper_bound:
  stages:
    stain_normalizer:
      class: "VahadaneStainNormalizer"
      params:
        target: "ZT111_4_C_7_1"
    superpixel_extractor:
      class: "SLICSuperpixelExtractor"
      params:
        nr_superpixels: 2000
        color_space: "rgb"
  params:
    cores: 16
train:
  data:
    overfit_test: False
    training_slides:
      - 111
      - 199
      - 204
    validation_slides:
      - 76
    patch_size: 2500
    graph_directory:  "outputs/v0"
  model:
    gnn_config:
      activation: "relu"
      agg_operator: "none"
      input_dim: 512
      hidden_dim: 64
      layer_type: "gin_layer"
      n_layers: 3
      output_dim: 64
      neighbor_pooling_type: "mean"
      graph_norm: False
      with_rlp: False
      edge_dim: 16
    graph_classifier_config:
      n_layers: 2
      hidden_dim: 64
    node_classifier_config:
      n_layers: 2
      hidden_dim: 32
  metrics:
    graph:
      - "GraphClassificationAccuracy"
    node:
      - "NodeAccuracy"
      - "NodeAccuracyWithoutBackground"
  params:
    optimizer:
      class: "Adam"
      params:
        lr: 0.0001
    batch_size: 32
    nr_epochs: 1000
    num_workers: 8
    node_loss_weight: 0.5
    node_loss_drop_probability: 0.0
